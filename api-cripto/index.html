<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Criptomoeadas</title>
</head>
<body>
	<header>
		<h1>Criptomoedas</h1>
	</header>
	<main>
		<section class="intro">
			<h2>O que é uma criptomoeda</h2>
			<p>Uma <strong>criptomoeda</strong> ou <strong>cibermoeda</strong> é um meio de troca, podendo ser centralizado ou descentralizado que se utiliza da tecnologia de blockchain e da criptografia para assegurar a validade das transações e a criação de novas unidades da moeda. O Bitcoin, foi a primeira criptomoeda descentralizada criada e, desde então, muitas outras criptomoedas foram criadas.</p>
			<p>Origem: <a href="https://pt.wikipedia.org/wiki/Criptomoeda">Wikepédia</a>, a enciclopédia livre.</p>
		</section>

		<section class="coins" data-js="coins">
			<h2>Criptomoeadas</h2>
			<p>Utilizando a API da <a href="https://coinmarketcap.com">Coin Market Cap</a> vamos exibir algumas criptomoedas.</p>
		</section>

		
	</main>
	<script type="text/javascript">
		// My API key
		const apikey = {
			key: '247bba66-c74a-4472-8e6b-217647925d4b'
		}
		// GET fetch requisition
		fetch('https://pro-api.coinmarketcap.com/v1/cryptocurrency/map?CMC_PRO_API_KEY=' + apikey.key)
			.then((response) => {
				if(!response.ok) throw new Error('Erro ao executar a requisição, status ' + response.status)
				return response.json()
			})
			.then((api) => {
				for (let i = 0; i < 10; i++) {
					showCoin(api.data[i].name, api.data[i].symbol, api.data[i].first_historical_data)
				}
			})
			.catch((error) => {
				console.error(error.message)
			})

		function showCoin(name, symbol, date) {
			const coinsSection = document.querySelector('[data-js="coins"]')
			
			const coinName = document.createElement('h3')
			coinName.textContent = name
			
			const formatedDate = formatDate(date)
				
			const coinDescription = document.createElement('p')
			coinDescription.textContent = `Apareceu pela primeira vez nos registros da Coin Market Cap em ${formatedDate} e o seu símbolo é ${symbol}.`
			
			coinsSection.appendChild(coinName)
			coinsSection.appendChild(coinDescription)
		}

		function formatDate(date) {
			const temp = new Date(date)
			const day = adicionaZero(temp.getDate().toString())
			const month = adicionaZero((temp.getMonth()+1).toString())
			const year = temp.getFullYear().toString()
			
			return `${day}/${month}/${year}`
		}

		function adicionaZero(number) {
			if (number <= 9)
				return "0" + number
			else
				return number
		}
	</script>
</body>
</html>